<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>角色管理</title>
    <link rel="stylesheet" href="../easyui/easyui.css" />
    <link rel="stylesheet" href="../css/icon.css" />
    <script src="../js/jquery.min.js" type="text/javascript"
            charset="utf-8"></script>
    <script src="../js/jquery.easyui.min.js" type="text/javascript"
            charset="utf-8"></script>
    <script src="../js/easyui-lang-zh_CN.js" type="text/javascript"
            charset="utf-8"></script>
</head>
<body>
<div>
    <a href="javascript:;" class="easyui-linkbutton" iconCls="icon-add" id="newUser">添加角色</a>
    <table id="dg" class="easyui-datagrid" title="角色管理" style="width:80%;"
           data-options="rownumbers:true,singleSelect:true,">
        <thead>
        <tr>
            <th data-options="field:'ck',checkbox:true"></th>
            <th data-options="field:'username',width:200">用户名</th>
            <th data-options="field:'rolename',width:300">角色</th>
        </tr>

        </thead>
        <tbody>
        <tr>
            <td data-options="field:'ck',checkbox:true"></td>
            <td>张三</td>
            <td>
                <select name="" style="width: 200px;">
                </select>
            </td>
        </tr>
        <tr>
            <td data-options="field:'ck',checkbox:true"></td>
            <td>张三</td>
            <td>
                <select name="" style="width: 200px;">
                </select>
            </td>
        </tr>
        </tbody>
    </table>


    <!--弹窗-->
    <div id="dialog" class="easyui-dialog" style="width: 400px;height: 300px;" data-options="resizable:true,modal:true">
        <form method="post" id="form">
            <div style="margin: 10px 0 0 10px;"><input name="adminRole" type="checkbox" value="监理"/>监理 </div> <br />
            <div style="margin: 10px 0 0 10px;"><input name="adminRole" type="checkbox" value="业务主管" />业务主管 </div> <br />
            <div style="margin: 10px 0 0 10px;"><input name="adminRole" type="checkbox" value="经理" />经理 </div> <br />
            <div style="margin: 10px 0 0 10px;"><input name="adminRole" type="checkbox" value="总经理" />总经理 </div> <br />

        </form>
    </div>
</div>
</body>

<script type="text/javascript">
        $(function () {
            // 获取按钮
            var newUser = $('#newUser');
            var dialog = $('#dialog');
            dialog.dialog('close');
            // 添加记录
            newUser.on('click',function () {
                var rows = $('#dg').datagrid('getSelected');
                if (rows) {
                    dialog.dialog('open');
                    dialog.dialog({
                        title:'添加角色',
                        buttons:[{
                            text:'保存',
                            iconCls:'icon-save',
                            handler:function () {
                                if ($('form input:checkbox:checked')) {
                                    var str=document.getElementsByName("adminRole");
                                    var shosetype=document.querySelector("select");
                                    var objarray=str.length;
                                    var chestr="";
                                    var option = '';
                                    for (i=0;i<objarray;i++)
                                    {
                                        if(str[i].checked == true)
                                        {
                                            chestr+=str[i].value+",";
                                            option += '<option value="' + i + '">' + str[i].value + '</option>';
                                        }
                                    }
                                    shosetype.innerHTML=option;
                                    if(chestr == "")
                                    {
                                        alert("请先选择一个角色～！");
                                    }
                                    dialog.dialog('close');
                                    $('#form').form('clear');
                                }
                            }
                        },
                            {
                                text:'取消',
                                iconCls:'icon-remove',
                                handler:function () {
                                    dialog.dialog('close');
                                },
                            }]
                    })
                } else{
                    alert('请选中一条数据!');
                }


            })
        })
    
</script>
</html>
