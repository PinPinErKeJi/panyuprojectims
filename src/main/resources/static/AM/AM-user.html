<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户管理</title>
</head>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../js/easyui-lang-zh_CN.js"></script>
<link rel="stylesheet" type="text/css" href="../easyui/easyui.css" id="style">
<link rel="stylesheet" type="text/css" href="../css/icon.css">
<link rel="stylesheet" type="text/css" href="../css/index.css">
<link rel="stylesheet" type="text/css" href="../css/menu.css">
<body class="easyui-layout">
<div data-options="region:'west',title:'用户信息',split:true" style="width:850px">
    <table id="dg1" class="easyui-datagrid" title="" style="width:850px;height:500px"
           data-options="url:'servlet/userServlet',fitColumns:true,singleSelect:true,pagination:true,pageList:[]">

        <thead>
        <tr>
            <th data-options="field:'UserId',width:40"> </th>
            <th data-options="field:'UserName',width:60">用户名</th>
            <th data-options="field:'UserPwd',width:120">用户密码</th>
            <th data-options="field:'_operate',width:120,align:'center',formatter:formatOper">操作</th>
        </tr>
        </thead>
    </table>
    <div id="tb1">
        <a href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="add()">增加用户</a>
    </div>
</div>
<!-- ++++++++++++++++++++弹出的增加用户框++++++++++++++++++++++++++++++++++++++++ -->
<div class="easyui-dialog" id="add"
     data-options="title:'增加用户',closable:true,closed:true,
        buttons:[{text:'确定',handler:queding},
        {text:'关闭',handler:function(){$('#add').dialog('close')}}]">

    <table>
        <tr><td>用户名:<td><input name="UserName" type="text" id="username"></td></td></tr>
        <tr><td>用户密码：<td><input name="UserPwd" type="text" id="userpwd"></td></td></tr>
    </table>


</div>

</body>
<script type="text/javascript">

    function formatOper(value,row,index){

        return '<a href="javascript:void(0);" onclick="bianjiUser('+index+')">编辑</a> <a href="javascript:void(0);" onclick="shanchuUser('+index+')">删除</a>';
    };
    //++++++++++增加用户按钮++++++++
    $("#dg1").datagrid({
        toolbar:'#tb1'
    });
    //+++++增加用户+++++
    function add(){
        $('#add').dialog('open').dialog({
            title:增加用户,
            modal: true
        });
    };

    function queding(){

        var message={
            "username":$("#username").val(),
            "userpwd":$("#userpwd").val(),
        };
        if($("#username").val()!=""&&$("#userpwd").val()!="")
        {
            $.ajax({
                type:"post",
                url:"servlet/adduserServlet",
                data:{"Message":JSON.stringify(message)},
                success:function(){
                    $('#dg1').datagrid('reload');
                    alert("添加成功！");
                    $("#username").val("");
                    $("#userpwd").val("");
                }
            })
            $('#add').dialog('close');


        }
        else{alert("请填写完整！");
            $("#username").val("");
            $("#userpwd").val("");
        }
    }
    //++++++++++用户编辑+++++++++++++
    function  bianjiUser(index){

        alert(index);
    }

    //++++++++++++用户删除++++++++++++++++
    function shanchuUser(index){
        $.ajax({
            type:"post",
            url:"servlet/shanchuServlet",
            data:{"index":index},
            success:function(){
                $("#dg1").datagrid('reload');
            }
        });

    }



    $('#f').combobox({
        url:'combobox_data.json',
        valueField:'id',
        textField:'text',
        loadFilter:function(data){
            var obj={};
            obj.id='';
            obj.text='-请选择-'
            data.splice(0,0,obj)//在数组0位置插入obj,不删除原来的元素
            return data;

        }


    });

</script>
</html>