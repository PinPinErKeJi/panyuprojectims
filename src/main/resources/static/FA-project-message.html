<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>设备基本信息</title>
    <link rel="stylesheet" href="easyui/easyui.css">
    <link rel="stylesheet" href="css/icon.css">
    <link rel="stylesheet" href="css/list.css">
    <link rel="stylesheet" href="css/bootstrap.css" />
    <link rel="stylesheet" href="css/bootstrap-theme.css" />
    <style>
        .border{
            height: 27px;
            width: 120px;
            border: 1px solid #95B8E7;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<form id="excelForm" method="post" enctype="multipart/form-data">
    <div>
        <a href="javascript:void(0)" class="easyui-linkbutton" plain="true"  data-options="iconCls:'icon-print'" onClick="FAExportEquipmentNullExcel();">导出Excel空表格</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" plain="true"  data-options="iconCls:'icon-print'" onClick="FAExportEquipmentInfoExcel();">导出工程基本信息</a>
        <input  id="fileName" class="easyui-filebox" name="fileName"  style="width:200px;vertical-align:middle;" />
        <a href="javascript:void(0)" onclick="FAimportEquipment()" class="easyui-linkbutton">导入工程基本信息</a>
    </div>
</form>
    <div data-toggle="distpicker" style="float: left">
        <select  id="province" class="border" data-province="河南省"></select>
        <select  id="city" class="border" data-city="郑州市"></select>
        <select  id="county" class="border" data-district="中原区"></select>
    </div>
    <div>
        <label>建设年份:</label><input id="construction-year" type="text" class="Wdate" onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy'})">
        <label>建设项目:</label><input id="construction-project" class="easyui-textbox" style="width: 120px">
        <label>运营商：</label><input id="operatorSearch" class="easyui-combobox" style="width:120px">
        <label>监理人员：</label><input id="supervisory" class="easyui-textbox" style="width:120px">
        <a id="search" class="easyui-linkbutton" iconCls="icon-search" style="width: 60px">搜索</a>
        <a href="javascript:;" class="easyui-linkbutton" iconCls="icon-add" id="newUser">添加</a>
        <!--<a href="javascript:;" class="easyui-linkbutton" iconCls="icon-edit" id="editUser">修改</a>-->
        <a href="javascript:;" class="easyui-linkbutton" iconCls="icon-remove" id="removeUser">移除</a>
    </div>
</div>
<div id="datagrid" class="easyui-datagrid panel-fit" style="height: 100%"></div>
<div id="dialog" class="easyui-dialog" style="width: 500px;height: 400px;overflow: scroll" data-options="resizable:true,modal:true">
    <form method="post" id="form">
        <div style="margin-bottom:20px">
            <label>建设年份:</label><input type="text" class="Wdate" name="buildYear" onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy'})">
        </div>
        <div style="margin-bottom:20px">
            <div data-toggle="distpicker" style="float: left">
                <select  id="form-province" class="border" data-province="河南省"></select>
                <select  id="form-city" class="border" data-city="郑州市"></select>
                <select  id="form-county" class="border" data-district="中原区"></select>
            </div>
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-combobox" label="运营商:" labelPosition="top" id="operator" name="operator" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="建设项目名称:" labelPosition="top"  required name="buildingProject" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="机房名称:" labelPosition="top" required name="motorRoomName" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="机房经度:" labelPosition="top" required name="motorRoomLongitude" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="机房纬度:" labelPosition="top" required name="motorRoomLatitude" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="现场监理:" labelPosition="top" required name="onSiteSupervision" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="项目负责人:" labelPosition="top" required name="projectLeader" style="width:100%;">
        </div>
        <a class="easyui-linkbutton" id="FA">设备,机柜,电源柜,配线架</a>
        <a class="easyui-linkbutton" id="broad">板卡扩容</a>
        <a class="easyui-linkbutton" id="EL">电源线,网线,2M线</a>
        <a class="easyui-linkbutton" id="pigtail">尾纤,跳纤</a>
        <a class="easyui-linkbutton" id="chute">走线架</a>
        <a class="easyui-linkbutton" id="trough">光纤槽道</a>
    </form>
</div>
<!--设备,机柜,电源柜,配线架-->
<div id="dialog-FA" class="easyui-dialog" style="width: 400px;height: 300px;overflow: scroll" data-options="resizable:true,modal:true">
    <form id="form-FA" method="post">
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="编号" labelPosition="top" required id="FA-number" name="equipmentNumber" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-combobox" label="类型" labelPosition="top" id="FA-type" name="equipmentType" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="名称" labelPosition="top" required id="FA-name" name="equipmentName" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="型号" labelPosition="top" required id="FA-model" name="equipmentModel" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-numberbox" label="设计数量" labelPosition="top" required id="FA-design-number" name="equipmentDesignQuantity" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="尺寸" labelPosition="top" required id="FA-size" name="equipmentSize" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="供货厂家" labelPosition="top" required id="FA-supplier" name="equipmentSupplier" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="联系人" labelPosition="top" required id="FA-contact" name="equipmentContacts" style="width:100%;">
        </div>
    </form>
</div>
<!--板卡扩容-->
<div id="dialog-broad" class="easyui-dialog" style="width: 400px;height: 300px;overflow: scroll" data-options="resizable:true,modal:true">
    <form id="form-broad" method="post">
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="编号" labelPosition="top" required id="broad-number" name="boardCardNumber" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="板卡名称" labelPosition="top" required id="broad-name" name="boardCardName" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="单板功能" labelPosition="top" required id="broad-function" name="veneerFunction" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="所在设备" labelPosition="top" required id="broad-FA" name="placeEquipment" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-numberbox" label="设计数量" labelPosition="top" required id="broad-design-number" name="boardCardDesignQuantity" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="供货厂家" labelPosition="top" required id="broad-supplier" name="boardCardSupplier" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="联系人" labelPosition="top" required id="broad-contact" name="boardCardContacts" style="width:100%;">
        </div>
    </form>
</div>
<!--电源线,网线,2M线-->
<div id="dialog-EL" class="easyui-dialog" style="width: 400px;height: 300px;overflow: scroll" data-options="resizable:true,modal:true">
    <form id="form-EL" method="post">
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="编号" labelPosition="top" required id="EL-number" name="powerNumber" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-combobox" label="线缆类型" labelPosition="top" id="EL-type" name="cableType" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="规格型号" labelPosition="top" required id="EL-model" name="specificationModel" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-numberbox" label="条数" labelPosition="top" required id="EL-count" name="numberOfBranches" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="单条长度(m)" labelPosition="top" required id="EL-length" name="singleLength" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="总长度(m)" labelPosition="top" required id="EL-all-length" name="totalLength" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="From" labelPosition="top" required id="EL-from" name="froms" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="To" labelPosition="top" required id="EL-to" name="to1" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="供货厂家" labelPosition="top" required id="EL-supplier" name="powerSupplier" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="联系人" labelPosition="top" required id="EL-contact" name="powerContacts" style="width:100%;">
        </div>
    </form>
</div>
<!--尾纤,跳纤-->
<div id="dialog-pigtail" class="easyui-dialog" style="width: 400px;height: 300px;overflow: scroll" data-options="resizable:true,modal:true">
    <form id="form-pigtail" method="post">
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="编号" labelPosition="top" required id="pigtail-number" name="pigtailNumber" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-combobox" label="线缆类型" labelPosition="top" id="pigtail-type" name="fiberCableType" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="规格型号" labelPosition="top" required id="pigtail-model" name="fiberSpecificationModel" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-numberbox" label="条数" labelPosition="top" required id="pigtail-count" name="fiberNumberOfBranches" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="单条长度(m)" labelPosition="top" required id="pigtail-length" name="fiberSingleLength" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="From" labelPosition="top" required id="pigtail-from" name="forms" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="To" labelPosition="top" required id="pigtail-to" name="to2" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="供货厂家" labelPosition="top" required id="pigtail-supplier" name="fiberSupplier" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="联系人" labelPosition="top" required id="pigtail-contact" name="fiberContacts" style="width:100%;">
        </div>
    </form>
</div>
<!--走线架-->
<div id="dialog-chute" class="easyui-dialog" style="width: 400px;height: 300px;overflow: scroll" data-options="resizable:true,modal:true">
    <form id="form-chute" method="post">
        <div style="margin-bottom:20px">
        <input class="easyui-textbox" label="编号" labelPosition="top" required id="chute-number" name="walkingNumber" style="width:100%;">
    </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="设计长度(m)" labelPosition="top" required id="chute-design-length" name="walkingDesignLength" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="供货厂家" labelPosition="top" required id="chute-supplier" name="walkingFrameSupplier" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="联系人" labelPosition="top" required id="chute-contact" name="walkingFrameContacts" style="width:100%;">
        </div>
    </form>
</div>
<!--光纤槽道-->
<div id="dialog-trough" class="easyui-dialog" style="width: 400px;height: 300px;overflow: scroll" data-options="resizable:true,modal:true">
    <form id="form-trough" method="post">
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="编号" labelPosition="top" required id="trough-number" name="fiberOpticNumber" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="设计长度(m)" labelPosition="top" required id="trough-design-length" name="fiberOpticDesignLength" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="供货厂家" labelPosition="top" required id="trough-supplier" name="fiberOpticSupplier" style="width:100%;">
        </div>
        <div style="margin-bottom:20px">
            <input class="easyui-textbox" label="联系人" labelPosition="top" required id="trough-contact" name="fiberOpticContacts" style="width:100%;">
        </div>
    </form>
</div>

<script src="js/jquery.min.js"></script>
<script src="js/jquery.easyui.min.js"></script>
<script src="js/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="js/distpicker/distpicker.js" ></script>
<script type="text/javascript" src="js/distpicker/distpicker.common.js" ></script>
<script type="text/javascript" src="js/distpicker/distpicker.esm.js" ></script>
<script type="text/javascript" src="js/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript">
    $(function () {
        var one = 0;
        var two = 0;
        var three = 0;
        var four = 0;
        var five = 0;
        var six = 0;

        var equipmentId;
        var boardCardDilatationId;
        var powerNetworkLineId;
        var pigtailSkipFiberId;
        var walkingFrameId;
        var fiberOpticChannelId;
        //初始化搜素框运营商的combobox
        $("#operatorSearch").combobox({
            editable:false,
            valueField:'id',
            textField:'name',
            panelHeight:'auto',
            data:[{
                id:'1',
                name:'中国电信'
            },{
                id:'2',
                name:'中国联通'
            },{
                id:'3',
                name:'中国移动'
            },{
                id:'4',
                name:'中国铁塔'
            },{
                id:'5',
                name:'中国广电'
            }]
        })
        //初始化运营商combobox
        $("#operator").combobox({
            editable:false,
            valueField:'id',
            textField:'name',
            panelHeight:'auto',
            required:true,
            data:[{
                id:'1',
                name:'中国电信'
            },{
                id:'2',
                name:'中国联通'
            },{
                id:'3',
                name:'中国移动'
            },{
                id:'4',
                name:'中国铁塔'
            },{
                id:'5',
                name:'中国广电'
            }]
        });
      //初始化设备,机柜,电源柜,配线架中的类型
        $("#FA-type").combobox({
            editable:false,
            valueField:'id',
            textField:'name',
            panelHeight:'auto',
            required:true,
            data:[{
                id:'1',
                name:'设备(利旧机柜)'
            },{
                id:'2',
                name:'设备(自带机柜)'
            },{
                id:'3',
                name:'电源柜'
            },{
                id:'4',
                name:'机柜'
            },{
                id:'5',
                name:'ODF'
            },{
                id:'6',
                name:'DDF'
            }]
        })
        //初始化电源线,网线,2M线中的线缆类型
        $("#EL-type").combobox({
            editable:false,
            valueField:'id',
            textField:'name',
            panelHeight:'auto',
            required:true,
            data:[{
                id:'1',
                name:'电源线'
            },{
                id:'2',
                name:'网线'
            },{
                id:'3',
                name:'2M线'
            }]
        })
        //初始化尾纤,跳纤中的线缆类型
        $("#pigtail-type").combobox({
            editable:false,
            valueField:'id',
            textField:'name',
            panelHeight:'auto',
            required:true,
            data:[{
                id:'1',
                name:'尾纤'
            },{
                id:'2',
                name:'跳纤'
            }]
        })
        //搜索事件
        $("#search").bind("click",function () {
            $("#datagrid").datagrid("load",{
                "province":$("#province").find("option:selected").val(),
                "city":$("#city").find("option:selected").val(),
                "county":$("#county").find("option:selected").val(),
                "buildYear":$("#construction-year").val(),
                "buildingProject":$("#construction-project").textbox("getValue").trim(),
                "operator":$("#operatorSearch").combobox("getText"),
                "onSiteSupervision":$("#supervisory").textbox("getValue").trim(),
                "projectLeader":$("#supervisory").textbox("getValue").trim(),
            });
            //console.log("运营商:"+operator)
        })
        //点击省份change事件
        $("#province").change(function () {
            $("#datagrid").datagrid("load",{
                "province":$("#province").find("option:selected").val(),
                "buildYear":$("#construction-year").val(),
                "buildingProject":$("#construction-project").textbox("getValue").trim(),
                "operator":$("#operatorSearch").combobox("getText"),
                "onSiteSupervision":$("#supervisory").textbox("getValue").trim(),
                "projectLeader":$("#supervisory").textbox("getValue").trim(),
            });
        })
        //点击城市change事件
        $("#city").change(function () {
            $("#datagrid").datagrid("load",{
                "province":$("#province").find("option:selected").val(),
                "city":$("#city").find("option:selected").val(),
                "buildYear":$("#construction-year").val(),
                "buildingProject":$("#construction-project").textbox("getValue").trim(),
                "operator":$("#operatorSearch").combobox("getText"),
                "onSiteSupervision":$("#supervisory").textbox("getValue").trim(),
                "projectLeader":$("#supervisory").textbox("getValue").trim(),
            });
        })
        //点击区(县)change事件
        $("#county").change(function () {
            $("#datagrid").datagrid("load",{
                "province":$("#province").find("option:selected").val(),
                "city":$("#city").find("option:selected").val(),
                "county":$("#county").find("option:selected").val(),
                "buildYear":$("#construction-year").val(),
                "buildingProject":$("#construction-project").textbox("getValue").trim(),
                "operator":$("#operatorSearch").combobox("getText"),
                "onSiteSupervision":$("#supervisory").textbox("getValue").trim(),
                "projectLeader":$("#supervisory").textbox("getValue").trim(),
            });
        });
        //运营商change事件
        $("#operatorSearch").combobox({
            onChange:function () {
                $("#datagrid").datagrid("load",{
                    "province":$("#province").find("option:selected").val(),
                    "city":$("#city").find("option:selected").text(),
                    "county":$("#county").find("option:selected").text(),
                    "buildYear":$("#construction-year").val(),
                    "buildingProject":$("#construction-project").textbox("getValue").trim(),
                    "operator":$("#operatorSearch").combobox("getText"),
                    "onSiteSupervision":$("#supervisory").textbox("getValue").trim(),
                    "professionPeople":$("#supervisory").textbox("getValue").trim(),
                    "districtHead":$("#supervisory").textbox("getValue").trim(),
                });
            }
        });



        var dialogFA = $('#dialog-FA');
        var formFA = $('#form-FA');
        var dialogBroad = $('#dialog-broad');
        var formBroad = $('#form-broad');
        var dialogEL = $('#dialog-EL');
        var formEL = $('#form-EL');
        var dialogPigtail = $('#dialog-pigtail');
        var formPigtail = $('#form-pigtail');
        var dialogChute = $('#dialog-chute');
        var formChute = $('#form-chute');
        var dialogTrough = $('#dialog-trough');
        var formTrough = $('#form-trough');
        //隐藏dialog窗口
        dialogFA.dialog("close");
        dialogBroad.dialog("close");
        dialogEL.dialog("close");
        dialogPigtail.dialog("close");
        dialogChute.dialog("close");
        dialogTrough.dialog("close");
        //设备,机柜,电源柜,配线架的点击事件
        $("#FA").bind("click", function () {
            dialogFA.dialog('open');// open
            //获取combobox的值
            //var FA_type=$("#FA-type").combobox("getText")
            dialogFA.dialog({
                title: '设备,机柜,电源柜,配线架',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        var equipmentType=$("#FA-type").combobox("getText")
                        formFA.form('submit', {
                            url: 'insertFaCabinetPowerFrame?equipmentType='+equipmentType,
                            onSubmit: function () {
                                return formFA.form('validate');
                            },
                            success: function (data) {
                                equipmentId = data;
                                one = 1;
                                dialogFA.dialog('close');// close
                                $("#FA").linkbutton('disable');//添加数据成功后button设为不可点击
                                //console.log(data);
                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        dialogFA.dialog('close');// close
                    }
                }]
            });
        });
        //板卡扩容的点击事件
        $("#broad").bind("click", function () {
            dialogBroad.dialog('open');// open
            dialogBroad.dialog({
                title: '板卡扩容',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        formBroad.form('submit', {
                            url: 'insertFaBoardcardDilatation',
                            onSubmit: function () {
                                return formBroad.form('validate');
                            },
                            success: function (data) {
                                boardCardDilatationId = data;
                                two = 1
                                dialogBroad.dialog('close');// close
                                $("#broad").linkbutton('disable');//添加数据成功后button设为不可点击
                                //console.log(data);
                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        dialogBroad.dialog('close');// close
                    }
                }]
            });
        });
        //电源线,网线,2M线的点击事件
        $("#EL").bind("click", function () {
            dialogEL.dialog('open');// open
            //var EL_type=$("#EL-type").combobox("getText");
            dialogEL.dialog({
                title: '电源线,网线,2M线',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        var cableType=$("#EL-type").combobox("getText");
                        formEL.form('submit', {
                            url: 'insertFaPowerNetworkLine?cableType='+cableType,
                            onSubmit: function () {
                                return formEL.form('validate');
                            },
                            success: function (data) {
                                powerNetworkLineId = data;
                                three = 1
                                dialogEL.dialog('close');// close
                                $("#EL").linkbutton('disable');//添加数据成功后button设为不可点击
                                //console.log(data);
                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        dialogEL.dialog('close');// close
                    }
                }]
            });
        });
        //尾纤,跳纤的点击事件
        $("#pigtail").bind("click", function () {
            dialogPigtail.dialog('open');// open
            //var pigtail_type=$("#pigtail-type").combobox("getText");
            dialogPigtail.dialog({
                title: '尾纤,跳纤',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        var fiberCableType=$("#pigtail-type").combobox("getText");
                        formPigtail.form('submit', {
                            url: 'insertFaPigtailSkipFiber?fiberCableType='+fiberCableType,
                            onSubmit: function () {
                                return formPigtail.form('validate');
                            },
                            success: function (data) {
                                pigtailSkipFiberId = data;
                                four = 1
                                dialogPigtail.dialog('close');// close
                                $("#pigtail").linkbutton('disable');//添加数据成功后button设为不可点击
                                //console.log(data);
                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        dialogPigtail.dialog('close');// close
                    }
                }]
            });
        });
        //走线架的点击事件
        $("#chute").bind("click", function () {
            dialogChute.dialog('open');// open
            dialogChute.dialog({
                title: '走线架',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        formChute.form('submit', {
                            url: 'insertFaWalkingFrame',
                            onSubmit: function () {
                                return formChute.form('validate');
                            },
                            success: function (data) {
                                walkingFrameId = data;
                                five = 1
                                dialogChute.dialog('close');// close
                                $("#chute").linkbutton('disable');//添加数据成功后button设为不可点击
                                //console.log(data);
                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        dialogChute.dialog('close');// close
                    }
                }]
            });
        });
        //光纤槽道的点击事件
        $("#trough").bind("click", function () {
            dialogTrough.dialog('open');// open
            dialogTrough.dialog({
                title: '光纤槽道',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        formTrough.form('submit', {
                            url: 'insertFaFiberOpticChannel',
                            onSubmit: function () {
                                return formTrough.form('validate');
                            },
                            success: function (data) {
                                fiberOpticChannelId = data;
                                six = 1
                                dialogTrough.dialog('close');// close
                                $("#trough").linkbutton('disable');//添加数据成功后button设为不可点击
                                //console.log(data);
                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        dialogTrough.dialog('close');// close
                    }
                }]
            });
        });

        var dialog = $('#dialog');
        var form = $('#form');

        // 隐藏弹窗
        dialog.dialog('close');
        // 数据表格
        $('#datagrid').datagrid({
            url: 'selectFaEquipmentInformation',
            pagination: true,
            pageNumber: 1,
            pageSize: 5,
            pageList: [2, 5, 8, 10, 20],
            columns:[[
                {field:'ck',checkbox:"true",rowspan:2},
                {field: 'equipmentInformationId', title: '序号', rowspan: 2, width: 50, align: 'center',hidden:true},
                {field: 'operator', title: '运营商', rowspan: 2, width: 50, align: 'center'},
                {field: 'buildYear', title: '建设年份', rowspan: 2, align: 'center', width: 80},
                {field: 'buildingProject', title: '建设项目名称', rowspan: 2, align: 'center', width: 80},
                {field: 'motorRoomName', title: '机房名称', rowspan: 2, align: 'center', width: 80},
                {field: 'motorRoomLongitude', title: '机房经度', rowspan: 2, align: 'center', width: 80},
                {field: 'motorRoomLatitude', title: '机房纬度', rowspan: 2, align: 'center', width: 80},
                {field: 'province', title: '省', rowspan: 2, align: 'center', width: 80},
                {field: 'city', title: '市', rowspan: 2, align: 'center', width: 80},
                {field: 'county', title: '区(县)', rowspan: 2, align: 'center', width: 80},
                {field: 'onSiteSupervision', title: '现场监理', rowspan: 2, align: 'center', width: 80},
                {field: 'projectLeader', title: '项目负责人', rowspan: 2, align: 'center', width: 80},
                {title: '设备,机柜,电源柜,配线架', colspan:8, align: 'center'},
                {title: '板卡扩容', colspan:7, align: 'center'},
                {title: '电源线,网线,2M线', colspan:10, align: 'center'},
                {title: '尾纤,跳纤', colspan:9, align: 'center'},
                {title: '走线架', colspan:4, align: 'center'},
                {title: '光纤槽道', colspan:4, align: 'center'},
            ],[
                {field: 'equipmentNumber', title: '编号', width: 80, align: 'center'},
                {field: 'equipmentType', title: '类型',  width: 80, align: 'center'},
                {field: 'equipmentName', title: '名称',  width: 80, align: 'center'},
                {field: 'equipmentModel', title: '型号',  width: 80, align: 'center'},
                {field: 'equipmentDesignQuantity', title: '设计数量',  width: 80, align: 'center'},
                {field: 'equipmentSize', title: '尺寸',  width: 80, align: 'center'},
                {field: 'equipmentSupplier', title: '供货厂家',  width: 80, align: 'center'},
                {field: 'equipmentContacts', title: '联系人',  width: 80, align: 'center'},
                {field: 'boardCardNumber', title: '编号',  width: 80, align: 'center'},
                {field: 'boardCardName', title: '板卡名称',  width: 80, align: 'center'},
                {field: 'veneerFunction', title: '单板功能',  width: 80, align: 'center'},
                {field: 'placeEquipment', title: '所在设备',  width: 80, align: 'center'},
                {field: 'boardCardDesignQuantity', title: '设计数量', width: 80, align: 'center'},
                {field: 'boardCardSupplier', title: '供货厂家',  width: 80, align: 'center'},
                {field: 'boardCardContacts', title: '联系人',  width: 80, align: 'center'},
                {field: 'powerNumber', title: '编号',  width: 80, align: 'center'},
                {field: 'cableType', title: '线缆类型',  width: 80, align: 'center'},
                {field: 'specificationModel', title: '规格型号',  width: 80, align: 'center'},
                {field: 'numberOfBranches', title: '条数',  width: 80, align: 'center'},
                {field: 'singleLength', title: '单条长度(m)',  width: 80, align: 'center'},
                {field: 'totalLength', title: '总长度(m)',  width: 80, align: 'center'},
                {field: 'froms', title: 'From:', width: 80, align: 'center'},
                {field: 'to1', title: 'To:',  width: 80, align: 'center'},
                {field: 'powerSupplier', title: '供货厂家', width: 80, align: 'center'},
                {field: 'powerContacts', title: '联系人', width: 80, align: 'center'},
                {field: 'pigtailNumber', title: '编号',  width: 80, align: 'center'},
                {field: 'fiberCableType', title: '线缆类型',  width: 80, align: 'center'},
                {field: 'fiberSpecificationModel', title: '规格型号',  width: 80, align: 'center'},
                {field: 'fiberNumberOfBranches', title: '条数',  width: 80, align: 'center'},
                {field: 'fiberSingleLength', title: '单条长度(m)',  width: 80, align: 'center'},
                {field: 'forms', title: 'From:', width: 80, align: 'center'},
                {field: 'to2', title: 'To:',  width: 80, align: 'center'},
                {field: 'fiberSupplier', title: '供货厂家',  width: 80, align: 'center'},
                {field: 'fiberContacts', title: '联系人',  width: 80, align: 'center'},
                {field: 'walkingNumber', title: '编号',  width: 80, align: 'center'},
                {field: 'walkingDesignLength', title: '设计长度(m)',  width: 80, align: 'center'},
                {field: 'walkingFrameSupplier', title: '供货厂家',  width: 80, align: 'center'},
                {field: 'walkingFrameContacts', title: '联系人',  width: 80, align: 'center'},
                {field: 'fiberOpticNumber', title: '编号',  width: 80, align: 'center'},
                {field: 'fiberOpticDesignLength', title: '设计长度(m)',  width: 80, align: 'center'},
                {field: 'fiberOpticSupplier', title: '供货厂家', width: 80, align: 'center'},
                {field: 'fiberOpticContacts', title: '联系人',  width: 80, align: 'center'},
            ]]
        });

        // 获取按钮
        var newUser = $('#newUser');
        var removeUser = $('#removeUser');

        // 添加记录
        newUser.on('click', function () {
            dialog.dialog('open');// open
            dialog.dialog({
                title: '添加记录',
                iconCls: 'icon-save',
                buttons: [{
                    text: '保存',
                    iconCls: 'icon-save',
                    handler: function () { // 新增数据
                        //获取运营商的值
                        var operator=$("#operator").combobox("getText");
                        //获取省市区的值
                        var province=$("#form-province").find("option:selected").text();
                        var city=$("#form-city").find("option:selected").text();
                        var county=$("#form-county").find("option:selected").text();
                        //alert(province+city+county);
                        form.form('submit', {
                            url: 'insertFaEquipmentInformation?province='+province+'&city='+city+'&county='+county+'&operator='+operator+'&equipmentId='+equipmentId+'&boardCardDilatationId='+boardCardDilatationId+'&powerNetworkLineId='+powerNetworkLineId+'&pigtailSkipFiberId='+pigtailSkipFiberId+'&walkingFrameId='+walkingFrameId+'&fiberOpticChannelId='+fiberOpticChannelId,
                            onSubmit: function () {
                                //提交表单时验证6个方法必须全都添加完成
                                if (one == 1 && two == 1 && three == 1 && four == 1 && five == 1 && six == 1) {
                                    return form.form('validate');
                                }
                                return false;
                            },
                            success: function (data) {
                                //添加成功后刷新datagrid数据
                                if (data){
                                    $("#datagrid").datagrid("load");
                                    dialog.dialog('close');// close

                                    form.form("reset");
                                    $("#FA").linkbutton('enable');
                                    $("#form-FA").form("reset");

                                    $("#broad").linkbutton('enable');
                                    $("#form-broad").form("reset");

                                    $("#EL").linkbutton('enable');
                                    $("#form-EL").form("reset");

                                    $("#pigtail").linkbutton('enable');
                                    $("#form-pigtail").form("reset");

                                    $("#chute").linkbutton('enable');
                                    $("#form-chute").form("reset");

                                    $("#trough").linkbutton('enable');
                                    $("#form-trough").form("reset");






                                    $.messager.alert("添加记录","添加记录成功!")
                                    //console.log(data);
                                }else{
                                    $.messager.alert("添加记录","添加数据失败!","error")
                                }

                            }
                        });
                    }
                }, {
                    text: '取消',
                    iconCls: 'icon-remove',
                    handler: function () {
                        //点击取消也刷新数据,清除form表单已填入的数据
                        $("#datagrid").datagrid("load")
                        dialog.dialog('close');// close
                    }
                }]
            });
        });
        // 移除记录
        removeUser.on('click', function () {
            // 移除选中的数据行
            if ($("#datagrid").datagrid('getSelected')) {
                var row = $("#datagrid").datagrid('getSelected');
                $.messager.confirm('移除记录', '确定移除吗?', function (result) {
                    if (result){
                        $.ajax({
                            url:'deleteFaEquipmentInformationById',
                            method:'post',
                            data:{equipmentInformationId:row.equipmentInformationId},
                            dataType:'json',
                            success:function (data) {
                                if (data){
                                    //删除成功后刷新数据
                                    $.messager.alert("删除记录","删除成功","info")
                                    $("#datagrid").datagrid("load")
                                } else {
                                    $.messager.alert("删除记录","删除失败","error")
                                }
                            }
                        })
                    }
                });
            } else {
                alert('请选择一条数据！');
            }
        });
        /**
         * linkbutton方法扩展
         * @param {Object} jq
         */
        $.extend($.fn.linkbutton.methods, {
            /**
             * 激活选项（覆盖重写）
             * @param {Object} jq
             */
            enable: function (jq) {
                return jq.each(function () {
                    var state = $.data(this, 'linkbutton');
                    if ($(this).hasClass('l-btn-disabled')) {
                        var itemData = state._eventsStore;
                        //恢复超链接
                        if (itemData.href) {
                            $(this).attr("href", itemData.href);
                        }
                        //回复点击事件
                        if (itemData.onclicks) {
                            for (var j = 0; j < itemData.onclicks.length; j++) {
                                $(this).bind('click', itemData.onclicks[j]);
                            }
                        }
                        //设置target为null，清空存储的事件处理程序
                        itemData.target = null;
                        itemData.onclicks = [];
                        $(this).removeClass('l-btn-disabled');
                    }
                });
            },
            /**
             * 禁用选项（覆盖重写）
             * @param {Object} jq
             */
            disable: function (jq) {
                return jq.each(function () {
                    var state = $.data(this, 'linkbutton');
                    if (!state._eventsStore)
                        state._eventsStore = {};
                    if (!$(this).hasClass('l-btn-disabled')) {
                        var eventsStore = {};
                        eventsStore.target = this;
                        eventsStore.onclicks = [];
                        //处理超链接
                        var strHref = $(this).attr("href");
                        if (strHref) {
                            eventsStore.href = strHref;
                            $(this).attr("href", "javascript:void(0)");
                        }
                        //处理直接耦合绑定到onclick属性上的事件
                        var onclickStr = $(this).attr("onclick");
                        if (onclickStr && onclickStr != "") {
                            eventsStore.onclicks[eventsStore.onclicks.length] = new Function(onclickStr);
                            $(this).attr("onclick", "");
                        }
                        //处理使用jquery绑定的事件
                        var eventDatas = $(this).data("events") || $._data(this, 'events');
                        if (eventDatas["click"]) {
                            var eventData = eventDatas["click"];
                            for (var i = 0; i < eventData.length; i++) {
                                if (eventData[i].namespace != "menu") {
                                    eventsStore.onclicks[eventsStore.onclicks.length] = eventData[i]["handler"];
                                    $(this).unbind('click', eventData[i]["handler"]);
                                    i--;
                                }
                            }
                        }
                        state._eventsStore = eventsStore;
                        $(this).addClass('l-btn-disabled');
                    }
                });
            }
        });
    });
    //导出空表格
    function FAExportEquipmentNullExcel(){
        var rowDatas = $("#datagrid").datagrid("getSelections");
        if(rowDatas.length==0){
            var ids = new Array(rowDatas.length);
            for(var i = 0; i<rowDatas.length; i++){
                ids[i] = rowDatas[i].equipmentInformationId;
            }
            window.location.href="FAExportEquipmentNullExcel?time="+new Date();
        }
    }

    //导出数据
    function FAExportEquipmentInfoExcel(){
        var rowDatas = $("#datagrid").datagrid("getSelections");
        //console.log(rowDatas+"信息数据");
        if(rowDatas.length==0){
            $.messager.alert("信息框","请选中要导出的数据","warning");
        }else{
            var ids = new Array(rowDatas.length);
            for(var i = 0; i<rowDatas.length; i++){
                ids[i] = rowDatas[i].equipmentInformationId;
            }
            //console.log(ids);
            window.location.href="FAExportEquipmentInfoExcel?ids="+ids+"&time="+new Date();
        }
    }

    //导入数据
    function importProjectProgress(){
        // 输入框的值，过滤是否选择文件
        var fileName = $("#fileName").filebox("getValue");
        var fileNameStr = fileName.substr(fileName.indexOf(".")+1);
        //console.log("fileName:"+fileName)
        //console.log("fileNameStr:"+fileNameStr)
        if(fileName==null || fileName==""){
            alert("请选择要导入的excel文件");
        }else if(fileNameStr=="xls" || fileNameStr=="xlsx"){
            var flag=true;
            if(flag){
                $.messager.confirm("确定对话框","确认导入吗？",function(n){
                    if(n){
                        $("#excelForm").form("submit",{
                            url:"parseExcelProjectProgress",
                            success:function (data) {
                                var jsObj = JSON.parse(data);
                                $.messager.alert("信息框",jsObj.isParse,"warning");
                                if(jsObj.isParse=="导入成功"){
                                    // $("#combobox-module").combobox('reload');
                                    $("#datagrid").datagrid("reload");
                                    var value = $("#fileName").textbox('getValue');  //获取值
                                    $("#fileName").textbox('setValue','')
                                }
                            }
                        })

                    }
                })
            }
        }else{
            $.messager.alert("提示框","文件类型不一致",'warning');
        }
    }
    //导入数据
    function FAimportEquipment(){
        // 输入框的值，过滤是否选择文件
        var fileName = $("#fileName").filebox("getValue");
        var fileNameStr = fileName.substr(fileName.indexOf(".")+1);
        //console.log("fileName:"+fileName)
        //console.log("fileNameStr:"+fileNameStr)
        if(fileName==null || fileName==""){
            alert("请选择要导入的excel文件");
        }else if(fileNameStr=="xls" || fileNameStr=="xlsx"){
            var flag=true;
            if(flag){
                $.messager.confirm("确定对话框","确认导入吗？",function(n){
                    if(n){
                        $("#excelForm").form("submit",{
                            url:"FAparseExcelFaEquipmentInformation",
                            success:function (data) {
                                var jsObj = JSON.parse(data);
                                $.messager.alert("信息框",jsObj.isParse,"warning");
                                if(jsObj.isParse=="导入成功"){
                                    // $("#combobox-module").combobox('reload');
                                    $("#datagrid").datagrid("reload");
                                    var value = $("#fileName").textbox('getValue');  //获取值
                                    $("#fileName").textbox('setValue','')
                                }
                            }
                        })

                    }
                })
            }
        }else{
            $.messager.alert("提示框","文件类型不一致",'warning');
        }
    }
</script>
</body>
</html>